CREATE TABLE CARTI(
COD_CARTE NUMBER(6),
TITLU VARCHAR2(30),
NUME_AUTOR VARCHAR2(20),
PRENUME_AUTOR VARCHAR2(20),
CATEGORIE VARCHAR2(20),
EDITURA VARCHAR2(20),
ID_ANTICARIAT NUMBER(4),
PRET NUMBER(9,2),
CONSTRAINT COD_CARTE_PK PRIMARY KEY(COD_CARTE),
CONSTRAINT PRET_CK CHECK (PRET>0),
CONSTRAINT NR_ANTICARIAT_FK FOREIGN KEY(ID_ANTICARIAT) REFERENCES ANTICARIATE(ID_ANTICARIAT)
);

CREATE TABLE CLIENTI(
ID_CLIENT NUMBER(5),
NUME_CLIENT VARCHAR2(20) NOT NULL,
PRENUME_CLIENT VARCHAR2(20) NOT NULL,
TELEFON VARCHAR2(12),
EMAIL VARCHAR2(30),
DATA_NASTERE DATE,
CONSTRAINT TELEFON_UQ UNIQUE(TELEFON),
CONSTRAINT ID_CLIENT_PK PRIMARY KEY (ID_CLIENT)
);

CREATE TABLE FACTURI(
ID_FACTURA NUMBER(10),
ID_CLIENT NUMBER(5),
ID_ANTICARIAT NUMBER(4),
DATA_EMITERE DATE NOT NULL,
CONSTRAINT ID_FACTURA_PK PRIMARY KEY(ID_FACTURA),
CONSTRAINT ID_CLIENT_FK FOREIGN KEY(ID_CLIENT)REFERENCES CLIENTI(ID_CLIENT),
CONSTRAINT ID_ANTICARIAT_FK FOREIGN KEY(ID_ANTICARIAT) REFERENCES ANTICARIATE(ID_ANTICARIAT)
);


CREATE TABLE ACHIZITII(
NR_ACHIZITIE NUMBER(10),
MODALITATE_PLATA VARCHAR2(10),
DATA_ACHIZITIE DATE NOT NULL,
ID_CLIENT NUMBER(5),
CONSTRAINT NR_ACHIZITIE_PK PRIMARY KEY(NR_ACHIZITIE),
CONSTRAINT ID_CLIE_FK FOREIGN KEY(ID_CLIENT) REFERENCES CLIENTI(ID_CLIENT),
ID_ANTICARIAT NUMBER(4)
);

CREATE TABLE  RAND_ACHIZITII(
NR_ACHIZITIE NUMBER(10),
COD_CARTE NUMBER(6),
PRET NUMBER(9,2),
CANTITATE NUMBER(4),
CONSTRAINT COD_CARTE_FK FOREIGN KEY(COD_CARTE) REFERENCES
CARTI(COD_CARTE),
CONSTRAINT NR_ACHI_FK FOREIGN KEY (NR_ACHIZITIE) REFERENCES
ACHIZITII(NR_ACHIZITIE)
);

ALTER TABLE CLIENTI ADD CONSTRAINT EMAIL_UQ UNIQUE(EMAIL);
ALTER TABLE ACHIZITII ADD CONSTRAINT ANTI_FK FOREIGN KEY(ID_ANTICARIAT)REFERENCES ANTICARIATE(ID_ANTICARIAT);

--SĂ SE REDENUMEASCĂ ENTITATEA CLIENTI CU CUMPARATORI:

RENAME CLIENTI TO CUMPARATORI;

--sa se adauge coloana varsta in tabela cumparatori

ALTER TABLE CUMPARATORI ADD (VARSTA NUMBER(2));

----------------------------------------------------------------------------------

--SA SE STREAGA COLOANA DATA_NASTERE DIN TABELA CUMPARATORI
ALTER TABLE CUMPARATORI DROP COLUMN DATA_NASTERE;

--sa se adauge coloana total in tabela FACTURI

ALTER TABLE FACTURI ADD TOTAL NUMBER(9,2);


--SA SE VIZULIZEZE DENUMIREA TABELELOR, RESTRICTIILE SI TIPUL ACESTORA PT UTILIZATORUL CURENT
SELECT OWNER, TABLE_NAME,CONSTRAINT_TYPE, CONSTRAINT_NAME FROM USER_CONSTRAINTS;

--sa se adauge minim 10 inreg pt fiecare tabela
INSERT INTO ANTICARIATE VALUES(1000,'BRAILA','IANCA','NICOLAE ONCESCU',3);
INSERT INTO ANTICARIATE VALUES(1001,'CONSTANTA','CONSTANTA','NICOLAE IORGA',56);
INSERT INTO ANTICARIATE VALUES(1002,'VRANCEA','FOCSANI','ELENA DOAMNA',90);
INSERT INTO ANTICARIATE VALUES(1003,'IASI','IASI','CAMIL RESSU',89);
INSERT INTO ANTICARIATE VALUES(1004,'ARAD','ARAD','MACIURIEI',99);
INSERT INTO ANTICARIATE VALUES(1005,'HARGHITA','MIERCUREA CIUC','MASINA DE PAINE',75);
INSERT INTO ANTICARIATE VALUES(1006,'OLT','SLATINA','CIRESILOR',63);
INSERT INTO ANTICARIATE VALUES(1007,'BRAILA','BRAILA','DOROBANTI',5);
INSERT INTO ANTICARIATE VALUES(1008,'BUZAU','BUZAU','MADGEARU',5);
INSERT INTO ANTICARIATE VALUES(1009,'BUCURESTI','SECTOR 3','UNITATII',128);
COMMIT;
SELECT * FROM ANTICARIATE;


INSERT INTO CARTI VALUES(100000,'BALADE VESELE SI TRISTE','TOPIRCEANU','GEORGE','BALADE','ERCPRESS',1002,20);
INSERT INTO CARTI VALUES(100001,'AMINTIRI DIN COPILARIE','CREANGA','ION','POVESTIRI','ARAMIS',1002,10);
INSERT INTO CARTI VALUES(100002,'CANTAREA ROMANIEI','RUSSO','ALECU','BALADE','HUMANITAS',1000,15);
INSERT INTO CARTI VALUES(100003,'O SCRISOARE PIERDUTA','CARAGIALE','ION LUCA','TEATRU','CRISAN',1009,20);
INSERT INTO CARTI VALUES(100004,'MOMENTE SI SCHITE','CARAGIALE','ION LUCA','TEATRU','HUMANITAS',1003,25);
INSERT INTO CARTI VALUES(100005,'ROSU SI NEGRU','STENDHAL','STENDHAL','TEATRU','CARAMIS',1009,40);
INSERT INTO CARTI VALUES(100006,'POEZII','EMINESCU','MIHAI','POEZII','ARAMIS',1005,30);
INSERT INTO CARTI VALUES(100007,'MOARA CU NOROC','SLAVICI','IOAN','POVESTIRI','HUMANITAS',1004,20);
INSERT INTO CARTI VALUES(100008,'ION','REBREANU','LIVIU','ROMAN','CORINT',1003,30);
INSERT INTO CARTI VALUES(100009,'ENIGMA OTILIEI','CALINESCU','GEORGE','ROMAN','ADEVARUL',1003,40);
COMMIT;
SELECT * FROM CARTI;


INSERT INTO CUMPARATORI VALUES(10000,'ARHIRE','ALEXANDRA','0749650192','ARHIREA',20);
INSERT INTO CUMPARATORI VALUES(10001,'BARBU','CIPRIAN','0746874598','BARBUC',20);
INSERT INTO CUMPARATORI VALUES(10002,'ARMANU','ALEXANDRU','0743785341','ARMANUA',20);
INSERT INTO CUMPARATORI VALUES(10003,'AFRASINEI','VLAD','0789647382','AFRASINEIV',21);
INSERT INTO CUMPARATORI VALUES(10004,'OPRESCU','IONEL','0789463782','OPRESCUI',38);
INSERT INTO CUMPARATORI VALUES(10005,'CRACIUN','EMILIA','0758741236','CRACIUNE',39);
INSERT INTO CUMPARATORI VALUES(10006,'TOADER','ANDREEA','0747896521','TOADERA',18);
INSERT INTO CUMPARATORI VALUES(10007,'FRANGU','ELVIRA','0748392039','FRANGUE',20);
INSERT INTO CUMPARATORI VALUES(10008,'TANASE','MARIA','0774865695','TANASEM',18);
INSERT INTO CUMPARATORI VALUES(10009,'GRIGORE','SEBASTIAN','0784938291','GRIGORES',38);
SELECT * FROM CUMPARATORI;



INSERT INTO ACHIZITII(NR_ACHIZITIE,MODALITATE_PLATA,DATA_ACHIZITIE) VALUES (900,'RAMBURS',TO_DATE('22-12-2021','DD-MM-YYYY'));
INSERT INTO ACHIZITII(NR_ACHIZITIE,MODALITATE_PLATA,DATA_ACHIZITIE) VALUES (901,'ONLINE',TO_DATE('20-04-2021','DD-MM-YYYY'));
INSERT INTO ACHIZITII(NR_ACHIZITIE,MODALITATE_PLATA,DATA_ACHIZITIE) VALUES (902,'RAMBURS',TO_DATE('14-03-2021','DD-MM-YYYY'));
INSERT INTO ACHIZITII(NR_ACHIZITIE,MODALITATE_PLATA,DATA_ACHIZITIE) VALUES (903,'ONLINE',TO_DATE('04-04-2021','DD-MM-YYYY'));
INSERT INTO ACHIZITII(NR_ACHIZITIE,MODALITATE_PLATA,DATA_ACHIZITIE) VALUES (904,'RAMBURS',TO_DATE('30-07-2021','DD-MM-YYYY'));
INSERT INTO ACHIZITII(NR_ACHIZITIE,MODALITATE_PLATA,DATA_ACHIZITIE) VALUES (905,'ONLINE',TO_DATE('02-04-2021','DD-MM-YYYY'));
INSERT INTO ACHIZITII(NR_ACHIZITIE,MODALITATE_PLATA,DATA_ACHIZITIE) VALUES (906,'RAMBURS',TO_DATE('20-07-2020','DD-MM-YYYY'));
INSERT INTO ACHIZITII(NR_ACHIZITIE,MODALITATE_PLATA,DATA_ACHIZITIE) VALUES (907,'RAMBURS',TO_DATE('28-02-2020','DD-MM-YYYY'));
INSERT INTO ACHIZITII(NR_ACHIZITIE,MODALITATE_PLATA,DATA_ACHIZITIE) VALUES (908,'ONLINE',TO_DATE('19-05-2021','DD-MM-YYYY'));
INSERT INTO ACHIZITII(NR_ACHIZITIE,MODALITATE_PLATA,DATA_ACHIZITIE) VALUES (909,'RAMBURS',TO_DATE('18-02-2021','DD-MM-YYYY'));
SELECT * FROM ACHIZITII;
COMMIT;

UPDATE ACHIZITII SET ID_CLIENT=10000 WHERE NR_ACHIZITIE=900;
UPDATE ACHIZITII SET ID_CLIENT=10001 WHERE NR_ACHIZITIE=901;
UPDATE ACHIZITII SET ID_CLIENT=10002 WHERE NR_ACHIZITIE=902;
UPDATE ACHIZITII SET ID_CLIENT=10003 WHERE NR_ACHIZITIE=903;
UPDATE ACHIZITII SET ID_CLIENT=10004 WHERE NR_ACHIZITIE=904;
UPDATE ACHIZITII SET ID_CLIENT=10005 WHERE NR_ACHIZITIE=905;
UPDATE ACHIZITII SET ID_CLIENT=10006 WHERE NR_ACHIZITIE=906;
UPDATE ACHIZITII SET ID_CLIENT=10007 WHERE NR_ACHIZITIE=907;
UPDATE ACHIZITII SET ID_CLIENT=10008 WHERE NR_ACHIZITIE=908;
UPDATE ACHIZITII SET ID_CLIENT=10009 WHERE NR_ACHIZITIE=909;
SELECT * FROM ACHIZITII;



UPDATE ACHIZITII SET ID_ANTICARIAT=1000 WHERE NR_ACHIZITIE=900;
UPDATE ACHIZITII SET ID_ANTICARIAT=1001 WHERE NR_ACHIZITIE=901;
UPDATE ACHIZITII SET ID_ANTICARIAT=1002 WHERE NR_ACHIZITIE=902;
UPDATE ACHIZITII SET ID_ANTICARIAT=1003 WHERE NR_ACHIZITIE=903;
UPDATE ACHIZITII SET ID_ANTICARIAT=1004 WHERE NR_ACHIZITIE=904;
UPDATE ACHIZITII SET ID_ANTICARIAT=1005 WHERE NR_ACHIZITIE=905;
UPDATE ACHIZITII SET ID_ANTICARIAT=1006 WHERE NR_ACHIZITIE=906;
UPDATE ACHIZITII SET ID_ANTICARIAT=1007 WHERE NR_ACHIZITIE=907;
UPDATE ACHIZITII SET ID_ANTICARIAT=1008 WHERE NR_ACHIZITIE=908;
UPDATE ACHIZITII SET ID_ANTICARIAT=1009 WHERE NR_ACHIZITIE=909;
SELECT * FROM ACHIZITII;

INSERT INTO RAND_ACHIZITII(nR_ACHIZITIE,COD_CARTE,CANTITATE) VALUES(901,100000,1);
INSERT INTO RAND_ACHIZITII(nR_ACHIZITIE,COD_CARTE,CANTITATE) VALUES(902,100001,1);
INSERT INTO RAND_ACHIZITII(nR_ACHIZITIE,COD_CARTE,CANTITATE) VALUES(903,100002,3);
INSERT INTO RAND_ACHIZITII(nR_ACHIZITIE,COD_CARTE,CANTITATE) VALUES(904,100003,2);
INSERT INTO RAND_ACHIZITII(nR_ACHIZITIE,COD_CARTE,CANTITATE) VALUES(905,100004,2);
INSERT INTO RAND_ACHIZITII(nR_ACHIZITIE,COD_CARTE,CANTITATE) VALUES(906,100005,1);
INSERT INTO RAND_ACHIZITII(nR_ACHIZITIE,COD_CARTE,CANTITATE) VALUES(907,100006,3);
INSERT INTO RAND_ACHIZITII(nR_ACHIZITIE,COD_CARTE,CANTITATE) VALUES(908,100007,2);
INSERT INTO RAND_ACHIZITII(nR_ACHIZITIE,COD_CARTE,CANTITATE) VALUES(909,100008,1);
INSERT INTO RAND_ACHIZITII(nR_ACHIZITIE,COD_CARTE,CANTITATE) VALUES(900,100009,7);
SELECT * FROM RAND_ACHIZITII;


UPDATE RAND_ACHIZITII SET PRET=20 WHERE COD_CARTE=100000;
UPDATE RAND_ACHIZITII SET PRET=10 WHERE COD_CARTE=100001;
UPDATE RAND_ACHIZITII SET PRET=15 WHERE COD_CARTE=100002;
UPDATE RAND_ACHIZITII SET PRET=20 WHERE COD_CARTE=100003;
UPDATE RAND_ACHIZITII SET PRET=25 WHERE COD_CARTE=100004;
UPDATE RAND_ACHIZITII SET PRET=40 WHERE COD_CARTE=100005;
UPDATE RAND_ACHIZITII SET PRET=30 WHERE COD_CARTE=100006;
UPDATE RAND_ACHIZITII SET PRET=20 WHERE COD_CARTE=100007;
UPDATE RAND_ACHIZITII SET PRET=30 WHERE COD_CARTE=100008;
UPDATE RAND_ACHIZITII SET PRET=40 WHERE COD_CARTE=100009;


INSERT INTO FACTURI(ID_FACTURA,ID_CLIENT,ID_ANTICARIAT,DATA_EMITERE) VALUES(1000000000,10000,1000,TO_DATE('24-12-2021','DD-MM-YYYY'));
INSERT INTO FACTURI(ID_FACTURA,ID_CLIENT,ID_ANTICARIAT,DATA_EMITERE) VALUES(1000000001,10001,1001,TO_DATE('28-02-2020','DD-MM-YYYY'));
INSERT INTO FACTURI(ID_FACTURA,ID_CLIENT,ID_ANTICARIAT,DATA_EMITERE) VALUES(1000000002,10002,1002,TO_DATE('04-04-2022','DD-MM-YYYY'));
INSERT INTO FACTURI(ID_FACTURA,ID_CLIENT,ID_ANTICARIAT,DATA_EMITERE) VALUES(1000000003,10003,1003,TO_DATE('14-03-2021','DD-MM-YYYY'));
INSERT INTO FACTURI(ID_FACTURA,ID_CLIENT,ID_ANTICARIAT,DATA_EMITERE) VALUES(1000000004,10004,1004,TO_DATE('30-07-2021','DD-MM-YYYY'));
INSERT INTO FACTURI(ID_FACTURA,ID_CLIENT,ID_ANTICARIAT,DATA_EMITERE) VALUES(1000000005,10005,1005,TO_DATE('27-11-2020','DD-MM-YYYY'));
INSERT INTO FACTURI(ID_FACTURA,ID_CLIENT,ID_ANTICARIAT,DATA_EMITERE) VALUES(1000000006,10006,1006,TO_DATE('13-05-2021','DD-MM-YYYY'));
INSERT INTO FACTURI(ID_FACTURA,ID_CLIENT,ID_ANTICARIAT,DATA_EMITERE) VALUES(1000000007,10007,1007,TO_DATE('29-06-2021','DD-MM-YYYY'));
INSERT INTO FACTURI(ID_FACTURA,ID_CLIENT,ID_ANTICARIAT,DATA_EMITERE) VALUES(1000000008,10008,1008,TO_DATE('18-02-2021','DD-MM-YYYY'));
INSERT INTO FACTURI(ID_FACTURA,ID_CLIENT,ID_ANTICARIAT,DATA_EMITERE) VALUES(1000000009,10009,1009,TO_DATE('16-05-2020','DD-MM-YYYY'));
SELECT * FROM FACTURI;



UPDATE FACTURI SET TOTAL=(SELECT MAX(PRET*CANTITATE)FROM RAND_ACHIZITII WHERE NR_ACHIZITIE=900)WHERE ID_FACTURA=1000000000;
UPDATE FACTURI SET TOTAL=(SELECT MAX(PRET*CANTITATE)FROM RAND_ACHIZITII WHERE NR_ACHIZITIE=901)WHERE ID_FACTURA=1000000001;
UPDATE FACTURI SET TOTAL=(SELECT MAX(PRET*CANTITATE)FROM RAND_ACHIZITII WHERE NR_ACHIZITIE=902)WHERE ID_FACTURA=1000000002;
UPDATE FACTURI SET TOTAL=(SELECT MAX(PRET*CANTITATE)FROM RAND_ACHIZITII WHERE NR_ACHIZITIE=903)WHERE ID_FACTURA=1000000003;
UPDATE FACTURI SET TOTAL=(SELECT MAX(PRET*CANTITATE)FROM RAND_ACHIZITII WHERE NR_ACHIZITIE=904)WHERE ID_FACTURA=1000000004;
UPDATE FACTURI SET TOTAL=(SELECT MAX(PRET*CANTITATE)FROM RAND_ACHIZITII WHERE NR_ACHIZITIE=905)WHERE ID_FACTURA=1000000005;
UPDATE FACTURI SET TOTAL=(SELECT MAX(PRET*CANTITATE)FROM RAND_ACHIZITII WHERE NR_ACHIZITIE=906)WHERE ID_FACTURA=1000000006;
UPDATE FACTURI SET TOTAL=(SELECT MAX(PRET*CANTITATE)FROM RAND_ACHIZITII WHERE NR_ACHIZITIE=907)WHERE ID_FACTURA=1000000007;
UPDATE FACTURI SET TOTAL=(SELECT MAX(PRET*CANTITATE)FROM RAND_ACHIZITII WHERE NR_ACHIZITIE=908)WHERE ID_FACTURA=1000000008;
UPDATE FACTURI SET TOTAL=(SELECT MAX(PRET*CANTITATE)FROM RAND_ACHIZITII WHERE NR_ACHIZITIE=909)WHERE ID_FACTURA=1000000009;
COMMIT;
SELECT * FROM FACTURI;


CREATE TABLE COPIE_CLIENTI AS SELECT * FROM CUMPARATORI;
INSERT INTO COPIE_CLIENTI VALUES(10010,'MUNTEANU','AMALIA','0747852136','MUNTEANUA',25);
INSERT INTO COPIE_CLIENTI VALUES(10011,'ALBU','ANELISE','0748751269','ALBUA',23);
SELECT * FROM COPIE_CLIENTI;


UPDATE CARTI SET PRET=PRET+PRET*0.2 WHERE PRET>20;
SELECT * FROM CARTI;


DELETE FROM FACTURI WHERE DATA_EMITERE<TO_DATE('01-05-2021','DD-MM-YYYY');
SELECT*FROM FACTURI;
ROLLBACK;


SELECT * FROM CUMPARATORI WHERE NUME_CLIENT LIKE '%U%';
SELECT *FROM ACHIZITII WHERE DATA_ACHIZITIE>TO_DATE('31-12-2020','DD-MM-YYYY') ORDER BY DATA_ACHIZITIE;
SELECT * FROM FACTURI WHERE ID_ANTICARIAT=1003;

SELECT C.ID_CLIENT,C.NUME_CLIENT,C.PRENUME_CLIENT,A.ID_ANTICARIAT,A.DATA_ACHIZITIE
FROM CUMPARATORI C, ACHIZITII A 
WHERE C.ID_CLIENT=A.ID_CLIENT;


SELECT CARTI.TITLU, RAND_ACHIZITII.CANTITATE, RAND_ACHIZITII.PRET, RAND_ACHIZITII.CANTITATE*RAND_ACHIZITII.PRET AS VALOARE 
FROM CARTI, RAND_ACHIZITII
WHERE CARTI.COD_CARTE=RAND_ACHIZITII.COD_CARTE;


SELECT C.TITLU,RA.CANTITATE,RA.PRET,RA.CANTITATE*RA.PRET AS VALOARE 
FROM CARTI C, RAND_ACHIZITII RA
WHERE C.COD_CARTE=RA.COD_CARTE
AND RA.PRET*RA.CANTITATE BETWEEN 10 AND 40 
ORDER BY VALOARE;


SELECT A.ID_ANTICARIAT,C.ID_CLIENT FROM FACTURI A, FACTURI C
WHERE A.ID_ANTICARIAT=C.ID_ANTICARIAT;


SELECT A.ID_ANTICARIAT, A.JUDET, C.COD_CARTE, C.CATEGORIE, C.TITLU, C.EDITURA FROM ANTICARIATE A, CARTI C
WHERE A.ID_ANTICARIAT=C.ID_ANTICARIAT(+);


SELECT C.TITLU, C.CATEGORIE, RA.PRET FROM CARTI C, RAND_ACHIZITII RA
WHERE C.COD_CARTE=RA.COD_CARTE
AND RA.PRET=(SELECT MIN(RAND_ACHIZITII.PRET) FROM RAND_ACHIZITII);


SELECT ID_ANTICARIAT, LOWER(JUDET),LOWER(LOCALITATE) FROM ANTICARIATE WHERE ID_ANTICARIAT>1005;

INSERT INTO CARTI VALUES(100010,'ARTA DE A TE IUBI','STAN','CRISTIAN','ROMAN','LITERA',1005,30.95);
INSERT INTO CARTI VALUES(100011,'ICKABOG','ROWLING','J.K','ROMAN','PARALELA 45',1004,56.4);
INSERT INTO CARTI VALUES(100012,'IERNILE SUFLETULUI','MAY','KATHERINE','ROMAN','ART',1007,34.9);

SELECT ROUND(PRET,0) FROM CARTI WHERE PRET>30;


SELECT NR_ACHIZITIE, DATA_ACHIZITIE FROM ACHIZITII WHERE EXTRACT(YEAR FROM DATA_ACHIZITIE) IN (2020);

SELECT NR_ACHIZITIE, DATA_ACHIZITIE FROM ACHIZITII WHERE EXTRACT(MONTH FROM DATA_ACHIZITIE) IN(2,3,4);

SELECT ' Anticariatul ' ||ID_ANTICARIAT|| ' are adresa: judetul ' ||JUDET|| ' orasul ' ||LOCALITATE|| ' strada ' ||STRADA|| ' nr ' ||NUMAR
FROM ANTICARIATE;

SELECT AVG(RA.CANTITATE*RA.PRET) MEDIA, MAX(RA.CANTITATE*RA.PRET) MAXIM, MIN(RA.CANTITATE*RA.PRET) MINIM, SUM(RA.CANTITATE*RA.PRET)SUMA_TOTALA FROM RAND_ACHIZITII RA;

SELECT A.NR_ACHIZITIE, TRUNC(SUM(RA.CANTITATE*RA.PRET))TOTAL_COMANDA 
FROM ACHIZITII A,RAND_ACHIZITII RA
WHERE A.NR_ACHIZITIE=RA.NR_ACHIZITIE
GROUP BY A.NR_ACHIZITIE
ORDER BY TOTAL_COMANDA DESC;


SELECT COUNT(*) NUMAR_CARTI FROM CARTI WHERE PRET<40;

SELECT ID_CLIENT, DATA_ACHIZITIE, ID_ANTICARIAT, LEVEL FROM ACHIZITII
CONNECT BY LEVEL=1 
START WITH ID_CLIENT>10003;

SELECT COD_CARTE, TITLU, EDITURA, PRET,
CASE WHEN PRET>40 THEN 0.3
WHEN PRET BETWEEN 20 AND 35 THEN 0.2
WHEN PRET BETWEEN 10 AND 20 THEN 0.1
ELSE 0 END REDUCERE 
FROM CARTI;


SELECT * FROM CARTI WHERE PRET BETWEEN 10 AND 20
MINUS
SELECT * FROM CARTI WHERE PRET BETWEEN 30 AND 40;


SELECT C.COD_CARTE, C.PRET
FROM CARTI C, RAND_ACHIZITII RA
WHERE C.COD_CARTE=RA.COD_CARTE
UNION 
SELECT C.COD_CARTE,RA.PRET*RA.CANTITATE
FROM CARTI C, RAND_ACHIZITII RA
WHERE C.COD_CARTE=RA.COD_CARTE;


SELECT C.TITLU, SUM(RA.PRET*RA.CANTITATE) VALOARE, COUNT(RA.NR_ACHIZITIE)
NUMAR_COMENZI
FROM CARTI C, RAND_ACHIZITII RA
WHERE RA.COD_CARTE=C.COD_CARTE
GROUP BY C.TITLU
INTERSECT
SELECT C.TITLU, SUM(RA.PRET*RA.CANTITATE)VALOARE, COUNT(RA.NR_ACHIZITIE)NRCOMENZI 
FROM CARTI C, RAND_ACHIZITII RA
WHERE RA.COD_CARTE=C.COD_CARTE
GROUP BY C.TITLU
HAVING SUM(RA.PRET*RA.CANTITATE)BETWEEN 30 AND 200;


CREATE OR REPLACE VIEW V_CLIENTI AS SELECT * FROM CUMPARATORI
WHERE ID_CLIENT>10003;
UPDATE V_CLIENTI SET VARSTA=VARSTA+15;
COMMIT;
SELECT*FROM V_CLIENTI;

SELECT VIEW_NAME,TEXT FROM USER_VIEWS;



SELECT * FROM ANTICARIATE WHERE JUDET LIKE '%U%';
CREATE INDEX INDEX_JUDET ON ANTICARIATE(JUDET);
SELECT*FROM ANTICARIATE WHERE JUDET LIKE '%U%';


CREATE SEQUENCE SEQ_NR_ACHIZITIE
START WITH 900
INCREMENT BY 1
MAXVALUE 1000 NOCYCLE;


SELECT * FROM USER_SEQUENCES;

CREATE SYNONYM CLIENTI FOR CUMPARATORI;
SELECT*FROM USER_SYNONYMS;
